<!--
Copyright 2023 The Cobalt Authors. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<!--
This file is used to generate a comprehensive list of Cobalt histograms
along with a detailed description for each histogram. See go/cobalt-telemetry
for details on how to modify this file.

For best practices on writing histogram descriptions, see
https://chromium.googlesource.com/chromium/src.git/+/HEAD/tools/metrics/histograms/README.md

Always run the pretty print utility on this file after editing:

  ./tools/metrics/histograms/pretty_print.py tools/metrics/histograms/metadata/cobalt/histograms.xml
-->

<histogram-configuration>

<histograms>

<!-- The names should match media::GetCodecNameForUMA(). -->

<variants name="VideoCodec">
  <variant name="AV1"/>
  <variant name="DolbyVision"/>
  <variant name="H264"/>
  <variant name="HEVC"/>
  <variant name="MPEG2"/>
  <variant name="MPEG4"/>
  <variant name="Theora"/>
  <variant name="VC1"/>
  <variant name="VP8"/>
  <variant name="VP9"/>
</variants>

<histogram name="Cobalt.DOM.CSS.Link.ParseTimeMicrosPerKB" units="microseconds"
    expires_after="never">
<!-- expires-never: Needed for long-term tracking of CSS parse performance. -->

  <owner>joeltine@google.com</owner>
  <summary>
    A normalized ratio of time to KB of CSS parsing for link tags. Only logs a
    sample for links loaded through HTTP/HTTPS and greater than 1KB. See
    go/cobalt-js-css-parsing-metrics for the full design.
  </summary>
</histogram>

<histogram name="Cobalt.DOM.CSS.Style.ParseTimeMicrosPerKB"
    units="microseconds" expires_after="never">
<!-- expires-never: Needed for long-term tracking of CSS parse performance. -->

  <owner>joeltine@google.com</owner>
  <summary>
    A normalized ratio of time to KB of CSS parsing for style tags. Only logs a
    sample for HTMLStyleElements with CSS greater than 1KB. See
    go/cobalt-js-css-parsing-metrics for the full design.
  </summary>
</histogram>

<histogram name="Media.PipelineStatus.AudioVideo.{VideoCodec}.{Pipeline}"
    enum="PipelineStatus" expires_after="never">
<!-- expires-never: Media pipeline health metric. -->

  <owner>sideboard@google.com</owner>
  <owner>cobalt-team@google.com</owner>
  <summary>
    Status of the media pipeline at the end of its lifecycle for audio-video
    streams with {VideoCodec} video codec using {Pipeline}.
  </summary>
  <token key="VideoCodec" variants="VideoCodec"/>
  <token key="Pipeline">
    <variant name="DDS.HW"
        summary="RendererImpl with hardware decoder and
                 DecryptingDemuxerStream"/>
    <variant name="DDS.SW"
        summary="RendererImpl with software decoder and
                 DecryptingDemuxerStream"/>
    <variant name="DVD" summary="RendererImpl with DecryptingVideoDecoder"/>
    <variant name="HW" summary="RendererImpl with hardware decoder"/>
    <variant name="MediaFoundationRenderer"/>
    <variant name="SW" summary="RendererImpl with software decoder"/>
    <variant name="UnknownRenderer" summary="an unknown Renderer"/>
  </token>
</histogram>

</histograms>

</histogram-configuration>
